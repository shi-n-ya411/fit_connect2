<div class="container mt-4">
<h1 class="text-center my-4"><%= @user.name %> さんのプロフィール</h1>
  <div class="row">
    <!-- 左カラム: ユーザープロフィール -->
    <div class="col-md-3">
      <div class="user-profile">
        

        <div class="card mb-4 shadow-sm">
          <div class="card-body text-center">
            <% if @user.profile_image.attached? %>
              <%= image_tag @user.profile_image.variant(resize: "150x150"), class: "rounded-circle border mb-3" %>
            <% else %>
              <p>プロフィール画像は設定されていません。</p>
            <% end %>

            <h5 class="card-title mt-3"><%= @user.name %></h5>

            <% if current_user != @user %> <!-- 自分自身をフォローできないようにする -->
              <% if current_user.following.include?(@user) %>
                <%= button_to 'フォロー解除', relationship_path(@user), method: :delete, class: 'btn btn-danger btn-sm mt-3' %>
              <% else %>
                <%= button_to 'フォローする', relationships_path(followed_id: @user.id), method: :post, class: 'btn btn-primary btn-sm mt-3' %>
              <% end %>
            <% end %>

            <p class="mt-3">フォロー数: <%= @user.following.count %></p>
            <p>フォロワー数: <%= @user.followers.count %></p>

            <p class="mt-3">自己紹介: <%= @user.introduction.presence || "自己紹介が登録されていません。" %></p>

            <% if current_user == @user %>
              <%= link_to 'プロフィールを編集', edit_user_path(@user), class: 'btn btn-primary btn-sm mt-3' %>
              <%= button_to 'アカウントを削除', user_path(@user), method: :delete, data: { confirm: '本当にアカウントを削除しますか？' }, class: 'btn btn-danger btn-sm mt-3' %>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- 右カラム: 投稿一覧 -->
    <div class="col-md-9">
      <h2 class="my-4">投稿一覧</h2>

      <% if @posts.present? %>
        <% @posts.each do |post| %>
          <div class="card mb-3 shadow-sm">
            <div class="card-body">
              <h5 class="card-title"><%= link_to post.title, post_path(post), class: "text-dark" %></h5>
              <p class="card-text"><%= truncate(post.content, length: 100) %></p>
              <p class="card-text text-muted">投稿日: <%= l(post.created_at, format: :short) %></p>
            </div>
          </div>
        <% end %>
      <% else %>
        <p>投稿はまだありません。</p>
      <% end %>
    </div>
  </div>
</div>
