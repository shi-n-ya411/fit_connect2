<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-sm p-4">
        <div class="post-detail">
          
          <!-- ÊäïÁ®ø„Çø„Ç§„Éà„É´ -->
          <h1 class="post-title border-bottom pb-2 mb-3 text-primary fw-bold">
            <%= @post.title %>
          </h1>

          <!-- ÊäïÁ®øËÄÖÊÉÖÂ†± -->
          <p class="post-author text-muted">
            ÊäïÁ®øËÄÖ: <%= link_to @post.user.name, user_path(@post.user), class: "fw-bold text-decoration-none text-dark" %>
          </p>

          <!-- ÊäïÁ®øÁîªÂÉèÔºàÊ∑ª‰ªò„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„ÅøË°®Á§∫Ôºâ -->
          <% if @post.image.attached? %>
            <div class="post-image text-center mb-3">
              <%= image_tag @post.image.variant(resize: "300x300").processed, class: "rounded shadow img-fluid", alt: @post.title %>
            </div>
          <% end %>

          <!-- ÊäïÁ®øÂÜÖÂÆπ -->
          <div class="post-content p-3 bg-light rounded">
            <p><%= @post.content %></p>
          </div>

          <!-- „ÅÑ„ÅÑ„Å≠Ê©üËÉΩ -->
          <div class="like-section mt-3">
            <% if current_user && current_user != @post.user %>
               <% if current_user.liked_posts.exists?(post.id) %>
                <%= button_to '<i class="fa-solid fa-circle-xmark"></i> „ÅÑ„ÅÑ„Å≠Ëß£Èô§', post_like_path(post), method: :delete, class: 'btn btn-danger' %>
              <% else %>
                <%= button_to '<i class="fa-solid fa-dumbbell"></i> „ÅÑ„ÅÑ„Å≠', post_like_path(post), method: :post, class: 'btn btn-primary' %>
              <% end %>
            <% end %>
            <span class="ms-2 fw-bold">„ÅÑ„ÅÑ„Å≠Êï∞: <%= @post.likes.count %></span>
          </div>

          <!-- „Ç≥„É°„É≥„Éà‰∏ÄË¶ß -->
          <h3 class="mt-4 border-bottom pb-2">üí¨ „Ç≥„É°„É≥„Éà‰∏ÄË¶ß</h3>
          <% @post.comments.each do |comment| %>
            <div class="comment-box p-2 bg-white rounded shadow-sm mt-2">
              <strong class="text-primary"><%= comment.user.name %></strong>: 
              <%= comment.content %>
              <% if comment.user == current_user %>
                <%= button_to "üóëÔ∏è ÂâäÈô§", post_comment_path(@post, comment), method: :delete, data: { confirm: "Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" }, class: "btn btn-sm btn-outline-danger ms-2" %>
              <% end %>
            </div>
          <% end %>

          <!-- „Ç≥„É°„É≥„ÉàÊäïÁ®ø -->
          <h3 class="mt-4">‚úçÔ∏è „Ç≥„É°„É≥„Éà„ÇíÊäïÁ®ø„Åô„Çã</h3>
          <%= form_with model: [@post, @post.comments.new], local: true, class: "mt-3" do |form| %>
            <div class="mb-2">
              <%= form.text_area :content, placeholder: "„Ç≥„É°„É≥„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ", class: "form-control" %>
            </div>
            <%= form.submit "üí¨ ÊäïÁ®ø", class: "btn btn-success" %>
          <% end %>

          <!-- „Éï„Ç©„É≠„ÉºÊ©üËÉΩ -->
          <div class="follow-section mt-4">
            <% if @post.user != current_user %> <!-- Ëá™ÂàÜËá™Ë∫´„ÅØ„Éï„Ç©„É≠„Éº‰∏çÂèØ -->
              <% if current_user.following?(@post.user) %>
                <%= button_to '‚ùå „Éï„Ç©„É≠„ÉºËß£Èô§', relationship_path(@post.user), method: :delete, class: 'btn btn-danger' %>
              <% else %>
                <%= button_to '‚ûï „Éï„Ç©„É≠„Éº„Åô„Çã', relationships_path(followed_id: @post.user.id), method: :post, class: 'btn btn-primary' %>
              <% end %>
            <% end %>
          </div>

          <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
          <div class="post-actions mt-4 d-flex gap-2">
            <%= link_to '‚úèÔ∏è Á∑®ÈõÜ', edit_post_path(@post), class: 'btn btn-warning' %>
            <%= link_to 'üóëÔ∏è ÂâäÈô§', post_path(@post), method: :delete, data: { confirm: 'Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü' }, class: 'btn btn-danger' %>
            <%= link_to '‚¨ÖÔ∏è Êàª„Çã', mypage_users_path, class: 'btn btn-secondary' %>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
